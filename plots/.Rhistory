z = z) +
scale_fill_gradientn(name = "Median",
space = "Lab",
colours = rainbow(7)) +  labs(x = "Longitude",y = "Latitude")
data4 <- na.omit(data4)
intp_coords <- interp(bus_locs$Longitude, bus_locs$Latitude, bus_locs$Voltage, duplicate = "median",
xo=seq(xmn,xmx, length=100),
yo=seq(ymn,ymx, length=100))
data4 <- data.frame(expand.grid(X=intp_coords$x, Y=intp_coords$y), z=c(intp_coords$z))
ggplot(data4) +
geom_tile(aes(X, Y, fill=z)) +
scale_fill_gradient(low="white", high="black", space = "Lab") +
coord_fixed(ratio = 1)
x <- rasterize(bus_locs[,5:4],r,Voltage,fun=mean)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
plot(x)
rtp <- rasterToPolygons(x)
rtp@data$id <- 1:nrow(rtp@data)   # add id column for join
rtpFort <- fortify(rtp, data = rtp@data)
rtpFortMer <- merge(rtpFort, rtp@data, by.x = 'id', by.y = 'id')
g <- g+ geom_polygon(data = rtpFortMer,
aes(x = long, y = lat, group = group, fill = layer),
alpha = 0.5,
size = 0) +  ## size = 0 to remove the polygon outlines
scale_fill_gradientn(colours = topo.colors(255))
g
g <- ggmap(mapten)+scale_x_continuous(limits = c(-90.6, -81), expand = c(0, 0)) +scale_y_continuous(limits = c(34.5, 37), expand = c(0, 0))
View(rtpFortMer)
g <- g+ geom_raster(x)
x@extent[1]
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
update_volt(10)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
update_volt(100)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
update_volt(1000)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
update_volt(1000)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
update_volt(2000)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
update_volt(1400)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
plot_raster_heatmapvolt<- function(t){
update_volt(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Voltage,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
}
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])
g
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapvolt(100)
source("../data/import_gmd.R")
import_data()
plot_raster_heatmapvolt(100)
plot_raster_heatmapvolt(150)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = topo.colors(255))
g
}
plot_raster_heatmapfreq(150)
plot_raster_heatmapfreq(160)
plot_raster_heatmapfreq(170)
plot_raster_heatmapfreq(180)
plot_raster_heatmapfreq(183)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=mean)
g <- g+ inset_raster(x, xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = topo.colors(255))
g
}
plot_raster_heatmapfreq(183)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=mean)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = topo.colors(255))
g
}
plot_raster_heatmapfreq(183)
plot_raster_heatmapfreq(184)
plot_raster_heatmapfreq(185)
plot_raster_heatmapfreq(186)
plot_raster_heatmapfreq(18)
plot_raster_heatmapfreq(18)
plot_raster_heatmapfreq(3)
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq(150)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = topo.colors(255))
g
}
plot_raster_heatmapfreq(150)
plot_raster_heatmapfreq(150)
x11()
plot_raster_heatmapfreq(250)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = topo.colors(255),guide = "colourbar")
g
}
plot_raster_heatmapfreq(250)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = topo.colors(255),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(250)
plot_raster_heatmapfreq(450)
x@extent[3]
x@extent[4]
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4],interpolate = TRUE)+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
geom_raster(data = x,aes(fill=Frequency))+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
geom_raster(data = as.raster(x),aes(fill=Frequency))+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
geom_raster(as.raster(x),aes(fill=Frequency))+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
geom_raster(x,aes(fill=Frequency))+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(450)
plot_raster_heatmapfreq(45)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ geom_rect(bus_locs,aes(x=Longitude,y=Latitude))
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(45)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ geom_rect(bus_locs,aes(x=Longitude,y=Latitude,),colour="green")
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(45)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green")
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(45)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(45)
tl <- list(a="a",b="b")
names(tl)
lapply(tl, function(x) NULL, simplify=FALSE, USE.NAMES=TRUE)
lapply(tl, function(x) x, simplify=FALSE, USE.NAMES=TRUE)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude), alpha=0.1, cex=0.1)+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude), alpha=0.5)+
scale_fill_gradientn(colours = c("red","yellow","blue"),guide = "colourbar")+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude), alpha=0.5)+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude), alpha=0.5)+
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
# geom_point(data=bus_locs, aes(x=Longitude,y=Latitude), alpha=0.5)+
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude), alpha=0.5)+
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(1000)
plot_raster_heatmapfreq(800)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude,fill=Frequency), alpha=0.5)+
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(800)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude,fill=Frequency), alpha=0.5)+
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
plot(r, col=terrain.colors(25, alpha=.25))
plot(gg, add=TRUE)
image(r, col=terrain.colors(25, alpha=.25), add=TRUE)
}
plot_raster_heatmapfreq(800)
plot(e, col=terrain.colors(25, alpha=.25))
plot(gg, add=TRUE)
image(e, col=terrain.colors(25, alpha=.25), add=TRUE)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude,fill=Frequency), alpha=0.5)+
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
plot(x, col=terrain.colors(25, alpha=.25))
plot(gg, add=TRUE)
image(x, col=terrain.colors(25, alpha=.25), add=TRUE)
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq<- function(t){
update_freq(t)
e <- extent(c(min(bus_locs$Longitude),max(bus_locs$Longitude),min(bus_locs$Latitude),max(bus_locs$Latitude)))
r <- raster(e)
x <- rasterize(bus_locs[,5:4],r,bus_locs$Frequency,fun=median)
g <- g+ #geom_rect(bus_locs,aes(x=Longitude,y=Latitude),colour="green") +
geom_point(data=bus_locs, aes(x=Longitude,y=Latitude,fill=Frequency), alpha=0.5)+
inset_raster(as.raster(x), xmin = x@extent[1], xmax = x@extent[2],
ymin = x@extent[3], ymax = x@extent[4])+
scale_fill_gradientn(colours = c("red","yellow","blue"),limits=c(min(Freq[,-1]),max(Freq[,-1])))+
theme(legend.position="bottom",legend.direction="vertical",legend.box="horizontal") +
ggtitle(bquote(atop("Frequency at Time",atop(.(Freq[t,1]),""))))
g
}
plot_raster_heatmapfreq(100)
plot_raster_heatmapfreq(200)
plot_raster_heatmapfreq(101)
plot_raster_heatmapfreq(150)
plot_raster_heatmapfreq(140)
plot_raster_heatmapfreq(130)
plot_raster_heatmapfreq(120)
plot_raster_heatmapfreq(121)
plot_raster_heatmapfreq(122)
plot_raster_heatmapfreq(722)
plot_raster_heatmapfreq(184)
x11()
plot_raster_heatmapfreq(181)
plot_raster_heatmapfreq(182)
plot_raster_heatmapfreq(183)
plot_raster_heatmapfreq(184)
plot_raster_heatmapfreq(185)
plot_raster_heatmapfreq(186)
plot_raster_heatmapfreq(187)
